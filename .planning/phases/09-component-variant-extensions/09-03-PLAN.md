---
phase: 09-component-variant-extensions
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - components/navigation/site-nav.tsx
  - components/navigation/mobile-menu.tsx
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Navigation is always sticky at the top of the viewport with backdrop blur (frosted glass effect) when content scrolls behind"
    - "Desktop navigation shows links (Home, Projects, Services, About, Contact) with active page underline accent in brand color"
    - "Mobile navigation shows hamburger button that opens a slide-from-right panel with navigation links"
    - "Dark mode toggle is always accessible in the navigation bar on both mobile and desktop"
    - "Mobile menu closes on Escape key, on backdrop click, and on link click"
    - "Navigation is present on all public pages via the root layout"
  artifacts:
    - path: "components/navigation/site-nav.tsx"
      provides: "Sticky navigation with backdrop blur, desktop links, mobile hamburger toggle, ThemeToggle, active page indicator"
      exports: ["SiteNav"]
      min_lines: 60
    - path: "components/navigation/mobile-menu.tsx"
      provides: "Slide-from-right mobile menu panel with backdrop overlay, keyboard handling, scroll lock"
      exports: ["MobileMenu"]
      min_lines: 40
    - path: "app/layout.tsx"
      provides: "Root layout wrapping all pages with SiteNav"
      contains: "SiteNav"
  key_links:
    - from: "components/navigation/site-nav.tsx"
      to: "components/theme-toggle.tsx"
      via: "import ThemeToggle"
      pattern: "ThemeToggle"
    - from: "components/navigation/site-nav.tsx"
      to: "components/navigation/mobile-menu.tsx"
      via: "import MobileMenu"
      pattern: "MobileMenu"
    - from: "app/layout.tsx"
      to: "components/navigation/site-nav.tsx"
      via: "import SiteNav into root layout"
      pattern: "SiteNav"
---

<objective>
Build the site navigation system with sticky header, backdrop blur, mobile hamburger menu, and active page indicators.

Purpose: Currently each page has its own ad-hoc header (just a ThemeToggle in a corner or a simple border-b bar). This plan creates a unified, professional navigation component that appears on all public pages. The sticky header with backdrop blur creates a premium feel. The mobile hamburger with slide-from-right panel provides proper mobile UX. Active page indicators help users understand where they are.

Output: New components/navigation/ directory with SiteNav and MobileMenu components, integrated into the root layout so every page gets consistent navigation.
</objective>

<execution_context>
@C:\Users\jonge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jonge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-component-variant-extensions/09-CONTEXT.md
@.planning/phases/09-component-variant-extensions/09-RESEARCH.md
@components/theme-toggle.tsx
@app/layout.tsx
@app/(home)/page.tsx
@app/projects/page.tsx
@app/projects/[slug]/page.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SiteNav and MobileMenu navigation components</name>
  <files>components/navigation/site-nav.tsx, components/navigation/mobile-menu.tsx</files>
  <action>
Create a new `components/navigation/` directory with two components.

**MobileMenu (components/navigation/mobile-menu.tsx):**
A "use client" component that renders a slide-from-right panel.

Props: `{ isOpen: boolean; onClose: () => void }`

Implementation:
- Fixed overlay backdrop: `fixed inset-0 z-40 bg-background/80 backdrop-blur-sm transition-opacity duration-[var(--duration-base)]`. When closed: `opacity-0 pointer-events-none`. When open: `opacity-100`. onClick calls onClose. aria-hidden="true".
- Fixed slide panel: `fixed inset-y-0 right-0 z-50 w-3/4 max-w-sm bg-background border-l border-border transform transition-transform duration-[var(--duration-base)] ease-smooth`. When closed: `translate-x-full`. When open: `translate-x-0`. `role="dialog" aria-modal="true" aria-label="Mobile navigation"`.
- Panel content: nav links (Home /, Projects /projects, Services /services, About /about, Contact /contact) as `<Link>` components (from next/link), each with `text-lg font-medium hover:text-primary transition-colors` and onClick={onClose}.
- Use `usePathname()` from next/navigation to determine active page. Active link gets `text-primary` color.
- Escape key handler: useEffect that adds keydown listener when isOpen, removes on cleanup.
- Scroll lock: When isOpen, set `document.body.style.overflow = "hidden"`, restore on cleanup.

**SiteNav (components/navigation/site-nav.tsx):**
A "use client" component that renders the sticky navigation header.

Implementation:
- `<header>` with classes: `sticky top-0 z-50 w-full border-b transition-colors duration-[var(--duration-base)]`
- Always use backdrop blur styling (per CONTEXT.md decision "always sticky with backdrop blur"): `border-border/40 bg-background/65 backdrop-blur-md supports-[backdrop-filter]:bg-background/60`
- Use pseudo-element pattern for performance: add `before:absolute before:inset-0 before:-z-10 before:backdrop-blur-md` on the header to isolate the blur layer from content rendering.
- Inner `<nav>` with `container flex h-14 items-center justify-between`
- Left: Logo link `<Link href="/">` with site name "JP Gerton" styled as `font-bold text-lg`
- Center/Right desktop links (hidden on mobile, visible md+): `<ul className="hidden md:flex items-center gap-lg">` with links for Home, Projects, Services, About, Contact
- Each desktop link: `<Link>` with `text-sm font-medium text-muted-foreground hover:text-foreground transition-colors relative` and an underline pseudo-element: `after:absolute after:bottom-[-2px] after:left-0 after:h-0.5 after:w-0 after:bg-primary after:transition-all after:duration-[var(--duration-base)] hover:after:w-full`
- Active link detection: Use `usePathname()` from next/navigation. When path matches, add `text-foreground after:w-full` to show the brand-colored underline permanently. For home, match exact "/". For others, match pathname starting with the route.
- Desktop ThemeToggle: Inside the desktop nav links list as the last item
- Mobile area (visible below md): `<div className="md:hidden flex items-center gap-sm">` with ThemeToggle and hamburger button
- Hamburger button: `<button>` with `p-2 hover:bg-accent rounded-md transition-colors` and proper aria-label="Toggle menu" / aria-expanded. Use an inline SVG (3 lines for menu, X for close) or import Menu/X from lucide-react.
- State: `const [mobileMenuOpen, setMobileMenuOpen] = useState(false)`
- Render `<MobileMenu>` inside the header component, passing isOpen and onClose.

**Performance notes to follow:**
- Use backdrop-blur-md (12px), not larger
- Provide `supports-[backdrop-filter]` fallback
- Use GPU-accelerated transforms for mobile menu slide
- Use `ease-smooth` (cubic-bezier(0.4, 0, 0.2, 1)) for natural motion via `ease-[var(--ease-smooth)]` or the Tailwind class if available
  </action>
  <verify>
Run `bun run build` to confirm no TypeScript errors. The components should import correctly (next/link, next/navigation for usePathname, theme-toggle). Check that the navigation/ directory exists and contains both files.
  </verify>
  <done>
SiteNav renders a sticky header with backdrop blur, desktop nav links with active underline indicators, ThemeToggle, and mobile hamburger. MobileMenu renders a slide-from-right panel with links, escape key handling, and scroll lock. Both components are "use client" and use Next.js Link + usePathname. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate SiteNav into root layout and remove per-page headers</name>
  <files>app/layout.tsx</files>
  <action>
Update app/layout.tsx to render SiteNav above the main content for all pages.

**Add import:** `import { SiteNav } from "@/components/navigation/site-nav";`

**Update the body content** to include SiteNav before the Providers children:
```
<body className="font-sans antialiased">
  <WebVitals />
  <Providers>
    <SiteNav />
    {children}
  </Providers>
  <Analytics />
  ...
</body>
```

SiteNav must be INSIDE Providers because it uses `useTheme` (via ThemeToggle) and `usePathname` (from next/navigation), both of which need client-side context. The ThemeProvider is inside Providers.

**Important:** Do NOT remove the per-page header elements in this task. Those inline headers (in home page, projects page, project detail page) will be cleaned up in a future plan or by the page integration phase (Phase 13). For now, the SiteNav provides the unified nav, and the per-page headers will become redundant but won't break anything visually since they just contain a ThemeToggle which will now appear twice (in SiteNav and in the page header). This is acceptable temporarily and avoids touching many page files in this plan.

**Admin exclusion consideration:** The admin layout (`app/admin/layout.tsx`) already has its own AdminHeader. Since SiteNav is in the root layout, it will appear on admin pages too. This is acceptable for now because:
1. Admin pages have their own layout that sits below root layout
2. The admin layout can hide or override the public nav in a future phase if needed
3. Admin is behind auth, so having the public nav visible is a minor UX issue, not a bug

If the admin layout conflict is problematic, a simple fix is to wrap SiteNav rendering in a conditional based on pathname, but that adds complexity. Leave it simple for now.
  </action>
  <verify>
Run `bun run build` to confirm no TypeScript errors. The import path `@/components/navigation/site-nav` should resolve correctly. Verify the layout structure has SiteNav inside Providers.
  </verify>
  <done>
app/layout.tsx renders SiteNav inside Providers, above children. All public pages now have a unified sticky navigation with backdrop blur, desktop links, mobile hamburger, and theme toggle. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` completes with zero errors
2. SiteNav appears on all pages (it's in root layout)
3. Desktop: Logo on left, nav links in center/right, theme toggle visible
4. Desktop: Active page shows brand-colored underline
5. Mobile: Hamburger button visible, theme toggle visible
6. Mobile: Tapping hamburger opens slide-from-right panel with nav links
7. Mobile: Panel closes on Escape, backdrop click, or link click
8. Sticky behavior: Nav stays at top during scroll with frosted glass backdrop blur
</verification>

<success_criteria>
- SiteNav and MobileMenu components exist in components/navigation/
- SiteNav is rendered in app/layout.tsx inside Providers
- Navigation is sticky with backdrop blur on all pages
- Desktop shows 5 nav links + ThemeToggle with active page indicator
- Mobile shows hamburger that opens slide-from-right panel
- Mobile menu handles Escape key, backdrop click, scroll lock
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-component-variant-extensions/09-03-SUMMARY.md`
</output>
