---
phase: 18-content-integration
plan: 03
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - app/(home)/page.tsx
autonomous: true

must_haves:
  truths:
    - "Home page shows 3 latest published blog posts in a section titled 'Insights & Updates' after Featured Projects and before Social Proof"
    - "Blog section is completely hidden when no published blog posts exist"
    - "Blog section includes a 'Read More' link to /blog"
    - "Testimonials on home page come from Convex database query, not hardcoded array"
    - "Testimonials section handles loading state (shows during loading, hides only if empty after load)"
    - "All placeholder comments referencing 'replace with real data' are removed from home page"
  artifacts:
    - path: "app/(home)/page.tsx"
      provides: "Home page with dynamic blog section and database-driven testimonials"
      min_lines: 200
  key_links:
    - from: "app/(home)/page.tsx"
      to: "api.blogPosts.listPublished"
      via: "useQuery hook"
      pattern: "useQuery.*blogPosts\\.listPublished"
    - from: "app/(home)/page.tsx"
      to: "api.testimonials.list"
      via: "useQuery hook"
      pattern: "useQuery.*testimonials\\.list"
    - from: "app/(home)/page.tsx"
      to: "components/blog/blog-post-card.tsx"
      via: "BlogPostCard component"
      pattern: "BlogPostCard"
---

<objective>
Add a dynamic blog section to the home page and replace hardcoded testimonials with Convex queries. Clean up all placeholder comments.

Purpose: The home page is the primary conversion surface. Adding recent blog posts shows content expertise to local business visitors. Dynamic testimonials mean new quotes can be added via Convex dashboard without code changes. This completes the home page's transition from static to dynamic content.

Output: Updated `app/(home)/page.tsx` with blog section, dynamic testimonials, and no placeholder comments.
</objective>

<execution_context>
@C:\Users\jonge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jonge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-content-integration/18-CONTEXT.md
@.planning/phases/18-content-integration/18-RESEARCH.md
@.planning/phases/18-content-integration/18-01-SUMMARY.md

@app/(home)/page.tsx
@components/blog/blog-post-card.tsx (reference: BlogPostCardProps interface)
@components/portfolio/testimonial-card.tsx (reference: TestimonialCardProps - accepts photo prop)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add blog section and dynamic testimonials to home page</name>
  <files>app/(home)/page.tsx</files>
  <action>
Modify the home page to add a blog section and replace hardcoded testimonials with Convex queries.

**1. Add imports:**
```typescript
import { BlogPostCard } from "@/components/blog/blog-post-card";
```

**2. Add queries in the component body** (after existing `useQuery(api.projects.list)`):
```typescript
const blogPosts = useQuery(api.blogPosts.listPublished, {});
const testimonials = useQuery(api.testimonials.list);
```

**3. Add a blog animation hook** alongside the existing animation hooks:
```typescript
const blogAnim = useIntersectionObserver<HTMLDivElement>();
```

**4. Remove the hardcoded `testimonials` array** (lines 43-59, the const with Sarah Mitchell and Marcus Chen). The data now comes from the `useQuery(api.testimonials.list)` call.

**5. Remove the "Placeholder testimonials" comment** (line 43).

**6. Add blog section JSX** - insert between the Featured Projects section (Section 3, ending around line 155) and the Social Proof section (Section 4, starting around line 157):

```tsx
{/* Section 3.5: Blog Posts - hidden when no posts */}
{blogPosts && blogPosts.length > 0 && (
  <SectionBackground variant="gradient">
    <div
      ref={blogAnim.elementRef}
      className={cn(
        "opacity-0 translate-y-5",
        "transition-[opacity,transform] duration-[var(--duration-entrance)] ease-[var(--ease-smooth)]",
        blogAnim.isVisible && "opacity-100 translate-y-0"
      )}
    >
      <h2 className="font-serif font-medium text-h2 leading-tight text-center mb-xs">
        Insights & Updates
      </h2>
      <p className="text-muted-foreground text-center mb-xl">
        Tips and stories for local businesses getting online
      </p>
      <div className="grid grid-cols-1 gap-lg">
        {blogPosts.slice(0, 3).map((post) => (
          <BlogPostCard
            key={post._id}
            title={post.title}
            slug={post.slug}
            excerpt={post.excerpt}
            coverImageUrl={post.coverImageUrl}
            coverImageAlt={post.coverImageAlt}
            category={post.category}
            readingTime={post.readingTime}
            publishedAt={post.publishedAt ?? 0}
          />
        ))}
      </div>
      <div className="text-center mt-xl">
        <Button asChild variant="link">
          <Link href="/blog">Read More</Link>
        </Button>
      </div>
    </div>
  </SectionBackground>
)}
```

Key implementation notes:
- Section heading is "Insights & Updates" (user decision, locked)
- CTA text is "Read More" (user decision, locked)
- Empty state: entire section hidden via `blogPosts && blogPosts.length > 0` conditional
- During loading (`blogPosts === undefined`), section is NOT shown (unlike projects which show during loading). This prevents layout shift since blog section is new and users won't expect it during load.
- Use existing `BlogPostCard` component (user discretion: reuse for consistency)
- Pass props explicitly (not spread) to match `BlogPostCardProps` interface exactly
- `publishedAt` uses `?? 0` fallback because Convex schema has it as optional
- Use `variant="gradient"` for SectionBackground to differentiate from the neutral Featured Projects section above
- Grid is single column (`grid-cols-1`) because BlogPostCard is already a horizontal layout (image left, content right). Stacking 3 cards vertically looks better than cramming into multi-column.

**7. Update testimonials section** to use the dynamic query data instead of the removed hardcoded array:

Replace the testimonials rendering block in Section 4. The `testimonials` variable now comes from `useQuery` instead of the hardcoded const.

The testimonials section should:
- Show during loading AND when data exists (same pattern as projects: `testimonials === undefined || (testimonials && testimonials.length > 0)`)
- Map over testimonials with `photoUrl` mapped to the `photo` prop of TestimonialCard:
```tsx
{(testimonials === undefined || (testimonials && testimonials.length > 0)) && (
  <>
    <h2 className="font-serif text-h3 leading-snug text-center mt-2xl mb-lg">
      What Clients Say
    </h2>
    <div className="grid grid-cols-1 md:grid-cols-2 gap-lg">
      {(testimonials ?? []).map((testimonial) => (
        <TestimonialCard
          key={testimonial._id}
          quote={testimonial.quote}
          name={testimonial.name}
          title={testimonial.title}
          company={testimonial.company}
          photo={testimonial.photoUrl ?? undefined}
        />
      ))}
    </div>
  </>
)}
```

Note: `TestimonialCard` accepts `photo?: string` (optional string). The Convex query returns `photoUrl: string | null`. Map `null` to `undefined` via `?? undefined`.

**8. Keep `services` and `metrics` arrays inline** (user discretion: no benefit to centralizing page-specific data).

**Summary of what changes in the file:**
- Added: `BlogPostCard` import
- Added: `blogPosts` and `testimonials` useQuery calls
- Added: `blogAnim` intersection observer hook
- Removed: hardcoded `testimonials` const array (lines 43-59)
- Removed: "Placeholder testimonials" comment (line 43)
- Added: Blog section JSX between Featured Projects and Social Proof
- Updated: Testimonials rendering to use query data with loading/empty handling
  </action>
  <verify>
Run `bun run type-check` inside the Docker container. Should pass with no errors.
Run `bun run lint` to verify no lint issues.
Run `bun run build` to confirm the page compiles and renders.
  </verify>
  <done>
Home page has a dynamic "Insights & Updates" blog section showing 3 latest posts (hidden when empty), testimonials come from Convex query (not hardcoded), and all placeholder comments are removed. The blog section sits after Featured Projects and before Social Proof as specified.
  </done>
</task>

<task type="auto">
  <name>Task 2: Final placeholder and TODO comment cleanup</name>
  <files>app/(home)/page.tsx, app/projects/[slug]/page.tsx</files>
  <action>
Perform a systematic search across `app/` and `components/` for any remaining misleading placeholder comments that reference future data layers, hardcoded content, or TODO items related to content integration.

Search patterns to check:
- "placeholder" (case-insensitive) in code comments
- "TODO" in code comments
- "Future enhancement" in code comments
- "replace with" or "replace later" in code comments
- "hardcoded" in code comments

Expected findings from the grep earlier:
1. `app/(home)/page.tsx` line 43: "Placeholder testimonials - replace with real data via admin/data layer later" -- should already be removed by Task 1
2. `app/projects/[slug]/page.tsx` line 76: "Future enhancement: add dedicated case study fields to Convex schema" -- should already be removed by Plan 02

Verify both are gone. If Task 1 or Plan 02 missed any, remove them now.

Do NOT touch:
- `placeholder` as an HTML attribute (e.g., `placeholder="Enter title"` in form inputs) - these are legitimate
- Comments in unrelated files (login page, form components, etc.)
- Comments that are still accurate and useful

If any new misleading comments are found in `app/` page files or `components/portfolio/` that reference placeholder data or future data layers, update them to reflect the current state (data is now dynamic via Convex).
  </action>
  <verify>
Search for misleading comments:
```bash
grep -rn "Placeholder\|Future enhancement.*case study\|replace.*later\|replace.*data layer" app/ components/portfolio/ --include="*.tsx" --include="*.ts"
```
Should return zero results (excluding HTML placeholder attributes).
  </verify>
  <done>
No misleading placeholder or TODO comments remain in page files or portfolio components. All references to "replace later", "future enhancement", or "placeholder data" have been removed or updated to reflect the current dynamic content implementation.
  </done>
</task>

</tasks>

<verification>
1. `bun run type-check` passes
2. `bun run lint` passes
3. `bun run build` succeeds
4. Blog section exists in home page JSX between Featured Projects and Social Proof
5. Blog section heading is "Insights & Updates" with "Read More" CTA linking to /blog
6. Blog section uses conditional rendering: `blogPosts && blogPosts.length > 0`
7. Testimonials use `useQuery(api.testimonials.list)` not hardcoded array
8. Testimonials handle loading state (show during load, hide when empty)
9. No hardcoded testimonials array exists in the file
10. No misleading placeholder/TODO comments in app/ or components/portfolio/
</verification>

<success_criteria>
- Home page shows "Insights & Updates" section with 3 latest blog posts after Featured Projects
- Blog section hidden when no published posts exist (no "coming soon" message)
- "Read More" CTA links to /blog
- Testimonials rendered from Convex query with loading/empty state handling
- TestimonialCard receives photoUrl mapped to photo prop
- All placeholder comments removed from home page and project detail page
- Type checks, lint, and build all pass
</success_criteria>

<output>
After completion, create `.planning/phases/18-content-integration/18-03-SUMMARY.md`
</output>
