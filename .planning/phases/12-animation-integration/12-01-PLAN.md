---
phase: 12-animation-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
  - components/ui/button.tsx
autonomous: true

must_haves:
  truths:
    - "Buttons visually depress on click with a subtle scale-down and spring back on release"
    - "Focus ring smoothly expands when element receives keyboard focus instead of appearing instantly"
    - "Users with prefers-reduced-motion enabled see no animations - all interactive elements appear in their final state instantly"
    - "All existing hover states (card lift, gradient shimmer, image zoom, nav underline) continue to work correctly"
    - "Form validation errors display with a smooth red border fade-in (INTR-05 coverage verified via Phase 9 transition-colors on input.tsx)"
  artifacts:
    - path: "app/globals.css"
      provides: "CSS keyframe animations (fade-up, fade-in), --duration-entrance token, prefers-reduced-motion global disable, focus ring transition"
      contains: "@keyframes fade-up"
    - path: "components/ui/button.tsx"
      provides: "Button press micro-interaction via active:scale-[0.97]"
      contains: "active:scale"
  key_links:
    - from: "app/globals.css"
      to: "all components"
      via: "prefers-reduced-motion media query"
      pattern: "prefers-reduced-motion: reduce"
    - from: "components/ui/button.tsx"
      to: "all button usages"
      via: "CVA base class active state"
      pattern: "active:scale"
    - from: "components/ui/input.tsx"
      to: "form validation state"
      via: "transition-colors with aria-invalid:border-destructive (Phase 9)"
      pattern: "transition-colors.*aria-invalid:border-destructive"
---

<objective>
Define CSS keyframe animations, add button press micro-interaction, and implement prefers-reduced-motion accessibility support.

Purpose: Establish the animation foundation that all interactive elements and scroll-triggered animations will build on. This plan creates the CSS infrastructure (keyframes, duration tokens, easing) and the global reduced-motion disable, ensuring accessibility is baked in from the start rather than bolted on later.

Output: globals.css with @keyframes definitions and prefers-reduced-motion styles, button.tsx with active state press feedback.
</objective>

<execution_context>
@C:\Users\jonge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jonge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-animation-integration/12-RESEARCH.md
@.planning/phases/12-animation-integration/12-CONTEXT.md
@app/globals.css
@components/ui/button.tsx
@components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS keyframes, focus ring animation, and prefers-reduced-motion support to globals.css</name>
  <files>app/globals.css</files>
  <action>
Add the following sections to app/globals.css AFTER the existing @layer base block:

0. **New duration token** in the existing `@theme` block (add alongside the existing --duration-fast/base/slow tokens):
   - `--duration-entrance: 250ms;`
   This token exists specifically for entrance/scroll-triggered animations. It sits between --duration-fast (150ms) and --duration-base (300ms), honoring the user's 200-250ms ceiling for non-hero animations while still feeling smooth for entrance effects.

1. **CSS Keyframe Animations** (outside any @media query, they are referenced by utility classes):
   - `@keyframes fade-up`: from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); }
   - `@keyframes fade-in`: from { opacity: 0; } to { opacity: 1; }
   These use GPU-accelerated properties only (opacity, transform). The 20px translateY distance comes from the CONTEXT.md decision.

2. **Animation utility classes** in `@layer utilities`:
   - `.animate-fade-up` using the fade-up keyframe with var(--duration-entrance) and var(--ease-smooth), fill mode `both`
   - `.animate-fade-in` using the fade-in keyframe with var(--duration-entrance) and var(--ease-smooth), fill mode `both`

3. **Focus ring animation** in `@layer base`:
   - Add a rule for `*:focus-visible` that applies `transition: box-shadow var(--duration-fast) var(--ease-smooth)` so focus rings animate in smoothly (150ms) when keyboard focus is received. This enhances the existing focus-visible:ring-2 styling from shadcn/ui.
   - Do NOT change the actual ring-2 or ring-offset-2 values. Only add the transition so the ring appearance is animated rather than instant.

4. **prefers-reduced-motion support** - a `@media (prefers-reduced-motion: reduce)` block at the end of the file:
   ```css
   @media (prefers-reduced-motion: reduce) {
     *,
     *::before,
     *::after {
       animation-duration: 0.01ms !important;
       animation-iteration-count: 1 !important;
       transition-duration: 0.01ms !important;
       scroll-behavior: auto !important;
     }
   }
   ```
   This is the global disable. It instantly resolves all animations and transitions to their final state, making the entire site fully static for motion-sensitive users. The 0.01ms (not 0ms) ensures transitionend/animationend events still fire for any JavaScript that listens for them.

   IMPORTANT: Do NOT add more specific selectors like `.animate-fade-up { opacity: 1 !important; }` here. The scroll-triggered animations in Plan 12-02 use Tailwind classes (opacity-0 -> opacity-100) controlled by JavaScript state, not CSS animations. The global transition-duration disable handles CSS transitions. The JavaScript Intersection Observer hook will handle initial visibility by checking `prefers-reduced-motion` and immediately setting elements to visible.

Do NOT modify any existing CSS in globals.css. Only ADD new sections after the existing content.

CONTEXT.MD locked decisions to honor:
- Duration ceiling: no animation longer than ~200-250ms unless hero/onboarding. Use --duration-entrance (250ms) for entrance animations, NOT --duration-base (300ms).
- Easing: ease-out preferred (var(--ease-smooth) is ease-out)
- Properties: only opacity + transform for keyframe animations
- Nothing loops unless communicating "waiting" or "live" state

INTR-05 verification (form feedback animations):
- Phase 9 already added `transition-colors duration-[var(--duration-fast)]` and `aria-invalid:border-destructive aria-invalid:border-2` to components/ui/input.tsx base class.
- This means when aria-invalid is set on an input, the border color transitions smoothly (150ms fade) from default to destructive red. This IS the "red border fade-in" specified in CONTEXT.md.
- Verify this by grepping input.tsx for `transition-colors` and `aria-invalid:border-destructive` to confirm both are present.
- No new code changes needed for INTR-05 form validation error animations.
  </action>
  <verify>Run `bun run build` and confirm no CSS errors. Grep globals.css for "@keyframes fade-up", "@keyframes fade-in", "prefers-reduced-motion: reduce", "focus-visible" transition, and "--duration-entrance" to confirm all five sections are present. Grep components/ui/input.tsx for "transition-colors" and "aria-invalid:border-destructive" to verify INTR-05 is already covered.</verify>
  <done>globals.css contains fade-up and fade-in keyframes (using --duration-entrance at 250ms), animation utility classes, focus ring transition, and a prefers-reduced-motion media query that disables all animations globally. INTR-05 form validation red border fade-in is verified as already implemented via Phase 9's transition-colors on input.tsx.</done>
</task>

<task type="auto">
  <name>Task 2: Add button press micro-interaction to button.tsx</name>
  <files>components/ui/button.tsx</files>
  <action>
Modify the base class string in the `buttonVariants` cva() call in components/ui/button.tsx.

Add these Tailwind classes to the base string (the first argument to cva):
- `active:scale-[0.97]` - Scale down to 97% on press (CONTEXT.md: tactile, not dramatic)
- `active:transition-transform` - Ensure transform transitions on active state
- `active:duration-[var(--duration-fast)]` - Fast 150ms press response

The base string currently includes `transition-colors duration-[var(--duration-base)]`. The active state classes will layer on top of the existing transition. The existing `transition-colors` handles color transitions, and the active state adds transform transition just for the press.

Additionally, the gradient variant already has `transition-[background-position]` which might conflict. To handle this cleanly:
- Change the base string's `transition-colors` to `transition-[color,background-color,transform]` so the base transition covers both colors AND transform in one declaration. This way the active:scale uses the base transition and the gradient variant overrides with its own `transition-[background-position]` plus inherits the transform from the base via the active pseudo-class.

Wait, actually this creates a conflict because the gradient variant needs to transition background-position, not the base properties. Keep it simpler:
- Keep existing base: `transition-colors duration-[var(--duration-base)]`
- Add to base: `active:scale-[0.97]` only
- The active state inherits the existing transition-colors, and Tailwind's transform utilities work without explicit transition because the scale change is instant on :active and reverses via the existing transition when released.

Actually, for the best feel per CONTEXT.md (asymmetric: fast press, smooth release):
- Add to base class: `transition-[color,background-color,border-color,text-decoration-color,fill,stroke,transform]` (replacing `transition-colors` to include transform)
- Keep: `duration-[var(--duration-base)]`
- Add: `active:scale-[0.97] active:duration-[var(--duration-fast)]`

This means: press happens at 150ms (fast), release at 300ms (base), which creates the natural feel specified in CONTEXT.md.

For the gradient variant, its `transition-[background-position]` will override the base transition for bg-position. That is fine because the gradient variant has its own transition property. The active:scale still works because Tailwind's transform is handled separately from transition-property.

Final approach - just add these to the END of the existing base class string:
```
active:scale-[0.97] active:duration-[var(--duration-fast)]
```

And change `transition-colors` to `transition-[color,background-color,border-color,text-decoration-color,fill,stroke,transform]` in the base class.

Leave all variants unchanged. The gradient variant's `transition-[background-position]` already specifies its own transition for the shimmer effect.
  </action>
  <verify>Run `bun run build` and confirm no TypeScript or build errors. Review button.tsx to confirm active:scale-[0.97] is present in the base class and transition includes transform.</verify>
  <done>All button variants show a subtle 97% scale-down on press and smooth release. The gradient variant's shimmer transition is unaffected. The active state uses fast duration (150ms) for responsive press, base duration (300ms) for smooth release.</done>
</task>

</tasks>

<verification>
1. `bun run build` passes with no errors
2. globals.css contains @keyframes fade-up and fade-in definitions
3. globals.css contains --duration-entrance: 250ms token in @theme block
4. globals.css contains prefers-reduced-motion: reduce media query with global animation/transition disable
5. globals.css contains focus-visible transition for ring animation
6. Animation utility classes use var(--duration-entrance), NOT var(--duration-base)
7. button.tsx base class includes active:scale-[0.97] and transform in transition
8. Existing hover states (card lg elevation, button gradient, nav underline) are unchanged
9. components/ui/input.tsx contains transition-colors and aria-invalid:border-destructive (INTR-05 verified)
</verification>

<success_criteria>
- CSS keyframe animations defined and available as utility classes (using --duration-entrance at 250ms)
- Button press gives tactile scale-down feedback on all variants
- Focus ring animates smoothly on keyboard focus
- prefers-reduced-motion globally disables all motion
- INTR-05 form validation red border fade-in verified as covered by Phase 9
- Build passes, no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/12-animation-integration/12-01-SUMMARY.md`
</output>
