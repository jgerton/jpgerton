---
phase: 01-infrastructure
plan: 04
type: execute
wave: 4
depends_on: ["01-03"]
files_modified:
  - tailwind.config.ts
  - app/globals.css
  - components/ui/button.tsx
  - components/ui/card.tsx
  - components/ui/input.tsx
  - components/ui/dialog.tsx
  - components/ui/toast.tsx
  - components/ui/avatar.tsx
  - components/ui/badge.tsx
  - components/theme-toggle.tsx
  - app/providers.tsx
  - app/layout.tsx
  - lib/utils.ts
  - components.json
autonomous: true

must_haves:
  truths:
    - "User can toggle between dark and light mode"
    - "Theme preference persists across page reloads"
    - "Default theme follows system preference on first visit"
    - "shadcn/ui components render with brand colors"
  artifacts:
    - path: "tailwind.config.ts"
      provides: "Custom brand colors and theme configuration"
      contains: "corporate-blue"
    - path: "components/theme-toggle.tsx"
      provides: "Theme toggle button component"
      contains: "useTheme"
    - path: "components/ui/button.tsx"
      provides: "shadcn/ui Button component"
      contains: "buttonVariants"
    - path: "app/providers.tsx"
      provides: "ThemeProvider wrapper"
      contains: "ThemeProvider"
  key_links:
    - from: "components/theme-toggle.tsx"
      to: "next-themes"
      via: "useTheme hook"
      pattern: "useTheme"
    - from: "app/providers.tsx"
      to: "next-themes"
      via: "ThemeProvider"
      pattern: "ThemeProvider"
    - from: "tailwind.config.ts"
      to: "Brand colors"
      via: "extend.colors"
      pattern: "corporate-blue.*#003F75"
---

<objective>
Configure Tailwind with brand colors and implement dark mode with shadcn/ui components.

Purpose: Establishes the visual foundation and component library for all UI development. Dark mode is a user-facing feature that persists.
Output: Working theme toggle, brand color palette, and pre-installed shadcn/ui components ready for Phase 2+ pages.
</objective>

<execution_context>
@C:\Users\jonge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jonge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-infrastructure/01-CONTEXT.md
@.planning/phases/01-infrastructure/01-RESEARCH.md
@.planning/phases/01-infrastructure/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Tailwind with brand colors and dark mode</name>
  <files>
    tailwind.config.ts
    app/globals.css
  </files>
  <action>
    Update tailwind.config.ts with brand colors from CONTEXT.md:

    ```typescript
    import type { Config } from "tailwindcss";

    const config: Config = {
      darkMode: ["class"],
      content: [
        "./pages/**/*.{ts,tsx}",
        "./components/**/*.{ts,tsx}",
        "./app/**/*.{ts,tsx}",
      ],
      theme: {
        extend: {
          colors: {
            // Brand colors from CONTEXT.md
            "corporate-blue": "#003F75",
            "tech-blue": "#2884BD",
            "turquoise": "#0FACB0",
            "soft-black": "#1A1A1A",
            "graphite": "#696969",
          },
          borderRadius: {
            lg: "12px",
            md: "8px",
            sm: "4px",
          },
          fontFamily: {
            sans: ["var(--font-inter)", "sans-serif"],
          },
        },
      },
      plugins: [require("tailwindcss-animate")],
    };

    export default config;
    ```

    Install required plugin:
    `bun add -d tailwindcss-animate`

    Update app/globals.css to include dark mode CSS variables (shadcn/ui pattern):

    ```css
    @tailwind base;
    @tailwind components;
    @tailwind utilities;

    @layer base {
      :root {
        --background: 0 0% 100%;
        --foreground: 0 0% 10%;
        --card: 0 0% 100%;
        --card-foreground: 0 0% 10%;
        --popover: 0 0% 100%;
        --popover-foreground: 0 0% 10%;
        --primary: 210 100% 23%; /* corporate-blue */
        --primary-foreground: 0 0% 100%;
        --secondary: 203 64% 44%; /* tech-blue */
        --secondary-foreground: 0 0% 100%;
        --muted: 0 0% 96%;
        --muted-foreground: 0 0% 45%;
        --accent: 178 92% 37%; /* turquoise */
        --accent-foreground: 0 0% 100%;
        --destructive: 0 84% 60%;
        --destructive-foreground: 0 0% 100%;
        --border: 0 0% 90%;
        --input: 0 0% 90%;
        --ring: 210 100% 23%;
        --radius: 8px;
      }

      .dark {
        --background: 0 0% 10%; /* soft-black */
        --foreground: 0 0% 95%;
        --card: 0 0% 12%;
        --card-foreground: 0 0% 95%;
        --popover: 0 0% 12%;
        --popover-foreground: 0 0% 95%;
        --primary: 203 64% 44%; /* tech-blue for dark mode */
        --primary-foreground: 0 0% 100%;
        --secondary: 210 100% 23%; /* corporate-blue */
        --secondary-foreground: 0 0% 100%;
        --muted: 0 0% 15%;
        --muted-foreground: 0 0% 65%;
        --accent: 178 92% 37%; /* turquoise */
        --accent-foreground: 0 0% 100%;
        --destructive: 0 62% 50%;
        --destructive-foreground: 0 0% 100%;
        --border: 0 0% 20%;
        --input: 0 0% 20%;
        --ring: 203 64% 44%;
      }
    }

    @layer base {
      * {
        @apply border-border;
      }
      body {
        @apply bg-background text-foreground;
      }
    }
    ```
  </action>
  <verify>
    tailwind.config.ts has darkMode: ["class"]
    tailwind.config.ts has corporate-blue, tech-blue, turquoise colors
    app/globals.css has :root and .dark CSS variable blocks
  </verify>
  <done>
    Tailwind configured with brand colors and dark mode CSS variables
  </done>
</task>

<task type="auto">
  <name>Task 2: Initialize shadcn/ui and install components</name>
  <files>
    components.json
    lib/utils.ts
    components/ui/button.tsx
    components/ui/card.tsx
    components/ui/input.tsx
    components/ui/dialog.tsx
    components/ui/toast.tsx
    components/ui/toaster.tsx
    components/ui/avatar.tsx
    components/ui/badge.tsx
    components/ui/form.tsx
  </files>
  <action>
    1. Initialize shadcn/ui:
       `bunx shadcn@latest init`

       When prompted:
       - Style: Default
       - Base color: Neutral (we've already customized colors)
       - CSS variables: Yes
       - tailwind.config location: tailwind.config.ts
       - Components location: @/components
       - Utils location: @/lib/utils
       - React Server Components: Yes

    2. Install the pre-selected component set from CONTEXT.md:
       `bunx shadcn@latest add button card input dialog toast avatar badge form`

       This installs:
       - Button: Primary action buttons
       - Card: Content containers
       - Input: Form inputs
       - Dialog: Modal dialogs
       - Toast: Notifications (via sonner or custom)
       - Avatar: User avatars
       - Badge: Status indicators
       - Form: react-hook-form integration

    3. Verify lib/utils.ts exists with cn() helper:
       ```typescript
       import { type ClassValue, clsx } from "clsx";
       import { twMerge } from "tailwind-merge";

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs));
       }
       ```

    4. Install any missing peer dependencies:
       `bun add clsx tailwind-merge class-variance-authority lucide-react`
  </action>
  <verify>
    components.json exists with shadcn/ui configuration
    lib/utils.ts exports cn function
    components/ui/button.tsx exists
    All 8 component files exist in components/ui/
  </verify>
  <done>
    shadcn/ui initialized with Button, Card, Input, Dialog, Toast, Avatar, Badge, Form components installed
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement dark mode toggle and verify</name>
  <files>
    app/providers.tsx
    app/layout.tsx
    components/theme-toggle.tsx
    app/page.tsx
  </files>
  <action>
    1. Install next-themes:
       `bun add next-themes`

    2. Update app/providers.tsx to include ThemeProvider:
       ```tsx
       "use client";

       import { ConvexProvider, ConvexReactClient } from "convex/react";
       import { ThemeProvider } from "next-themes";
       import { ReactNode } from "react";

       const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

       export function Providers({ children }: { children: ReactNode }) {
         return (
           <ConvexProvider client={convex}>
             <ThemeProvider
               attribute="class"
               defaultTheme="system"
               enableSystem
               disableTransitionOnChange
             >
               {children}
             </ThemeProvider>
           </ConvexProvider>
         );
       }
       ```

    3. Update app/layout.tsx with suppressHydrationWarning:
       ```tsx
       import { Inter } from "next/font/google";
       import "./globals.css";
       import { Providers } from "./providers";

       const inter = Inter({
         subsets: ["latin"],
         display: "swap",
         variable: "--font-inter",
       });

       export const metadata = {
         title: "jpgerton.com",
         description: "Web development services by Jon Gerton",
       };

       export default function RootLayout({
         children,
       }: {
         children: React.ReactNode;
       }) {
         return (
           <html lang="en" className={inter.variable} suppressHydrationWarning>
             <body className="font-sans antialiased">
               <Providers>{children}</Providers>
             </body>
           </html>
         );
       }
       ```

    4. Create components/theme-toggle.tsx per CONTEXT.md (icon with tooltip, 2-state only):
       ```tsx
       "use client";

       import { Moon, Sun } from "lucide-react";
       import { useTheme } from "next-themes";
       import { Button } from "@/components/ui/button";
       import { useEffect, useState } from "react";

       export function ThemeToggle() {
         const { theme, setTheme } = useTheme();
         const [mounted, setMounted] = useState(false);

         // Prevent hydration mismatch
         useEffect(() => {
           setMounted(true);
         }, []);

         if (!mounted) {
           return (
             <Button variant="ghost" size="icon" disabled>
               <Sun className="h-5 w-5" />
             </Button>
           );
         }

         return (
           <Button
             variant="ghost"
             size="icon"
             onClick={() => setTheme(theme === "light" ? "dark" : "light")}
             title={theme === "light" ? "Switch to dark mode" : "Switch to light mode"}
           >
             <Sun className="h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
             <Moon className="absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
             <span className="sr-only">Toggle theme</span>
           </Button>
         );
       }
       ```

    5. Update app/page.tsx to showcase theme toggle and components:
       ```tsx
       "use client";

       import { useQuery } from "convex/react";
       import { api } from "@/convex/_generated/api";
       import { ThemeToggle } from "@/components/theme-toggle";
       import { Button } from "@/components/ui/button";
       import { Card, CardHeader, CardTitle, CardDescription, CardContent } from "@/components/ui/card";
       import { Badge } from "@/components/ui/badge";

       export default function Home() {
         const health = useQuery(api.functions.health.check);

         return (
           <main className="flex min-h-screen flex-col items-center justify-center p-8 bg-background">
             <div className="absolute top-4 right-4">
               <ThemeToggle />
             </div>

             <h1 className="text-4xl font-bold mb-8 text-foreground">jpgerton.com</h1>

             <Card className="w-full max-w-md">
               <CardHeader>
                 <CardTitle className="flex items-center gap-2">
                   Infrastructure Status
                   <Badge variant={health ? "default" : "secondary"}>
                     {health ? "Connected" : "Loading"}
                   </Badge>
                 </CardTitle>
                 <CardDescription>
                   Phase 1 verification page
                 </CardDescription>
               </CardHeader>
               <CardContent className="space-y-4">
                 <div className="text-sm">
                   {health ? (
                     <p className="text-green-600 dark:text-green-400">
                       Convex: {health.status} at {new Date(health.timestamp).toLocaleTimeString()}
                     </p>
                   ) : (
                     <p className="text-yellow-600 dark:text-yellow-400">Connecting to Convex...</p>
                   )}
                 </div>

                 <div className="flex gap-2">
                   <Button variant="default">Primary</Button>
                   <Button variant="secondary">Secondary</Button>
                   <Button variant="outline">Outline</Button>
                 </div>
               </CardContent>
             </Card>
           </main>
         );
       }
       ```

    6. Restart Docker and verify:
       `docker compose down && docker compose up --build`

    7. Test in browser at http://localhost:3400:
       - Click theme toggle - should switch between light/dark
       - Refresh page - theme preference should persist
       - Verify brand colors appear on buttons/cards
       - Check no flash of wrong theme on page load

    8. Commit all styling changes:
       `git add tailwind.config.ts app/globals.css components/ lib/ components.json app/providers.tsx app/layout.tsx app/page.tsx package.json bun.lockb`
       `git commit -m "feat(ui): add dark mode and shadcn/ui components

       - Brand colors: corporate-blue, tech-blue, turquoise
       - Dark mode with next-themes (system preference default)
       - Theme toggle component (sun/moon icons)
       - shadcn/ui: button, card, input, dialog, toast, avatar, badge, form
       - CSS variables for theme consistency"`
  </action>
  <verify>
    http://localhost:3400 shows theme toggle in top right
    Clicking toggle switches between light and dark mode
    Theme persists after page refresh (check localStorage for "theme" key)
    Brand colors visible on buttons (corporate-blue primary)
    No FOUC (flash of unstyled content) on page load
  </verify>
  <done>
    Dark mode toggle works with persistence, shadcn/ui components styled with brand colors
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Theme toggle switches between light/dark mode
2. Preference persists in localStorage across sessions
3. First visit defaults to system preference
4. Brand colors visible in components (corporate-blue, tech-blue, turquoise)
5. All shadcn/ui components render correctly in both themes
6. No flash of wrong theme on page load
</verification>

<success_criteria>
- Dark/light mode toggle works (2-state, no system option in UI per CONTEXT.md)
- Theme persists in localStorage
- System preference respected on first visit
- Brand colors applied (#003F75, #2884BD, #0FACB0)
- 8 shadcn/ui components installed and working
- Inter font applied site-wide
- Ready for CI/CD setup in Plan 05
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure/01-04-SUMMARY.md`
</output>
