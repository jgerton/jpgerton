# Milestone v1.2: Content Layer + Launch

**Status:** IN PROGRESS
**Phases:** 15-19
**Total Plans:** TBD

## Overview

The site gains a complete content management system for blog posts and case studies, replacing placeholder data with dynamic content from Convex. Every project showcases real case studies, the blog serves dual audiences (local businesses and technical readers), and the site is production-ready for SEO-driven growth.

## Phases

### Phase 15: Content Schema + Backend

**Goal**: Blog posts and case studies have complete backend infrastructure in Convex with queries, mutations, indexes, and auth checks ready for admin UI integration.
**Depends on**: v1.1 Phase 14 (shipped)
**Requirements**: BLOG-01, BLOG-03, BLOG-04, BLOG-05, BLOG-06, BLOG-08, CASE-01, CASE-02, CASE-03
**Plans**: TBD

**Success Criteria:**
1. Admin can create blog post with title, excerpt, markdown content, category, and cover image
2. Blog post auto-generates URL-safe slug from title with manual override capability
3. Slug collisions automatically append numeric suffix without user intervention
4. Blog post can be saved as draft or published with timestamp tracking
5. Admin can create case study linked to existing project with problem/solution/results sections
6. Case study displays quantitative metrics (3-5 data points per study)

**Details:**
- New Convex tables: `blogPosts`, `caseStudies` (following existing projects table pattern)
- Schema fields: blogPosts (title, slug, excerpt, content, coverImageId, authorId, status, publishedAt, category, displayOrder), caseStudies (projectId, problemHeading/Content, solutionHeading/Content, resultsHeading/Content, metrics array)
- Server-side slug generation with slugify library, uniqueness enforced via Convex index
- Convex storage integration for blog cover images (generateUploadUrl pattern)
- Category enum: Local Business, Technical, Announcement
- Auth checks on all mutations (getAuthUserId)
- Queries: list (with status filter), getBySlug, getByProject (case studies)

### Phase 16: Admin Content Management

**Goal**: Admin dashboard has complete CRUD interfaces for blog posts and case studies with markdown editing, live preview, drag-to-reorder, and image upload.
**Depends on**: Phase 15
**Requirements**: BLOG-02, BLOG-07, CASE-04, CASE-05, DEBT-02
**Plans**: TBD

**Success Criteria:**
1. Admin can edit existing blog post and see live markdown preview side-by-side
2. Admin can delete own blog posts with confirmation dialog
3. Admin can drag-to-reorder blog posts in list view
4. Admin can upload cover image for blog post via Convex storage
5. Admin can edit and delete case studies with confirmation
6. Admin can reorder case studies via drag-and-drop
7. Hardcoded Calendly URL extracted to environment variable

**Details:**
- New admin tabs: Blog, Case Studies (following existing Projects tab pattern)
- Markdown editor: @uiw/react-md-editor with live preview (admin-only, code-split)
- Drag-to-reorder: replicate existing SortableProjectList pattern using dnd-kit
- Image upload: file input with preview, Convex generateUploadUrl
- Delete confirmation: AlertDialog with destructive action
- Extract NEXT_PUBLIC_CALENDLY_URL to .env.local and site-config.ts
- AdminTabs component updated with 2 new tabs

### Phase 17: Public Blog Pages

**Goal**: Users can discover and read blog posts with category filtering, server-side markdown rendering, syntax highlighting, pagination, and complete SEO metadata.
**Depends on**: Phase 15
**Requirements**: BLOG-09, BLOG-10, BLOG-11, BLOG-12, BLOG-13
**Plans**: TBD

**Success Criteria:**
1. User can view list of published blog posts at /blog with latest-first ordering
2. User can filter blog list by category (Local Business, Technical, Announcement)
3. User can navigate through blog posts using cursor-based pagination (20 per page)
4. User can read full blog post at /blog/[slug] with formatted markdown
5. Code blocks in blog posts display syntax highlighting for JS/TS/CSS/Bash
6. Draft posts return 404 when accessed directly via URL
7. Each blog post has unique OG image, meta description, and Article schema

**Details:**
- New routes: app/blog/page.tsx (list), app/blog/[slug]/page.tsx (detail)
- Server-side markdown rendering: react-markdown + remark-gfm + rehype-highlight
- Selective language imports for syntax highlighting (JS, TS, CSS, Bash only)
- Cursor-based pagination via Convex .paginate() (NOT .collect())
- BlogPostCard component with cover image, excerpt, category badge, read time
- BlogPostContent component with prose styling (custom, no @tailwindcss/typography)
- Category filter: URL param with Convex query integration
- Draft check in query: status === "published" filter
- generateMetadata() with dynamic OG image (next/og ImageResponse)
- JSON-LD Article schema with author, publishedAt, category

### Phase 18: Content Integration

**Goal**: All existing pages display real case study and blog data from Convex, replacing every hardcoded placeholder with dynamic queries.
**Depends on**: Phase 15, Phase 16, Phase 17
**Requirements**: CASE-06, CASE-07
**Plans**: TBD

**Success Criteria:**
1. Project detail pages display linked case study using CaseStudyVisual component
2. Home page displays 3 latest blog posts in "Insights & Updates" section with "Read More" CTA
3. All placeholder case study data removed from codebase
4. No hardcoded testimonial or case study content remains in any component

**Details:**
- Update app/projects/[slug]/page.tsx with case study query, pass to CaseStudyVisual
- Add "Insights & Updates" section to home page using BlogPostCard (3 posts)
- Remove all hardcoded case study props from project pages
- Verify CaseStudyVisual, TestimonialCard receive only dynamic props
- Grep for "placeholder" comments and remove all instances
- Admin data entry: create 3 initial blog posts, 3 case studies

### Phase 19: Launch Prep + Tech Debt

**Goal**: Site is production-ready with complete SEO/AEO configuration, analytics, default OG image, and all technical debt from v1.1 audit resolved.
**Depends on**: Phase 18
**Requirements**: LNCH-01, LNCH-02, LNCH-03, DEBT-01
**Plans**: TBD

**Success Criteria:**
1. Default OG image (1200x630) appears on all pages without post-specific images
2. Google Analytics 4 tracks page views via NEXT_PUBLIC_GA_ID environment variable
3. Robots.txt and sitemap.xml include blog posts
4. Noindex meta tag removed from all pages
5. Orphaned HeroSection component deleted from codebase
6. Site passes Lighthouse SEO audit (95+ score)

**Details:**
- Create default OG image: 1200x630 PNG with site branding in public/og-default.png
- Update layout.tsx and page.tsx files with default OG image fallback
- Add Google Analytics script to layout.tsx with NEXT_PUBLIC_GA_ID check
- Generate sitemap.xml with blog post URLs (app/sitemap.ts)
- Update robots.txt to allow all crawlers
- Remove noindex from root layout metadata
- Delete components/portfolio/HeroSection.tsx (replaced by HeroWithGradient in v1.1)
- Run Lighthouse audit on 3 pages: home, blog list, blog detail
- Performance budget check: LCP <200ms, bundle <250KB, Lighthouse 95+

---

## Milestone Summary

**Phase Coverage:**

| Phase | Requirements Covered | Count |
|-------|---------------------|-------|
| 15. Content Schema + Backend | BLOG-01, BLOG-03, BLOG-04, BLOG-05, BLOG-06, BLOG-08, CASE-01, CASE-02, CASE-03 | 9 |
| 16. Admin Content Management | BLOG-02, BLOG-07, CASE-04, CASE-05, DEBT-02 | 5 |
| 17. Public Blog Pages | BLOG-09, BLOG-10, BLOG-11, BLOG-12, BLOG-13 | 5 |
| 18. Content Integration | CASE-06, CASE-07 | 2 |
| 19. Launch Prep + Tech Debt | LNCH-01, LNCH-02, LNCH-03, DEBT-01 | 4 |

**Total:** 25/25 requirements (100% coverage)

**Key Architectural Patterns:**
- Extend existing Convex CRUD patterns from projects table
- Server-side markdown rendering (react-markdown + remark/rehype)
- Cursor-based pagination (.paginate(), not .collect())
- Selective syntax highlighting (4 languages only, server-side)
- Reuse composition components (CaseStudyVisual, TestimonialCard)
- Dynamic OG images via next/og ImageResponse

**Critical Constraints:**
- Convex free tier: projected 32K calls/month (3% of 1M limit)
- Performance budget: LCP <200ms, bundle <250KB, Lighthouse 95+
- Security: react-markdown auto-sanitizes, never dangerouslySetInnerHTML
- Accessibility: WCAG AA maintained from v1.1

**Dependencies Added:**
- react-markdown ^10.1.0 (~20KB)
- remark-gfm ^4.0.0 (~5KB)
- rehype-highlight ^7.0.0 (~8KB)
- @uiw/react-md-editor ^4.0.11 (~4.6KB, admin-only)
- slugify ^1.6.6 (~2KB)
- dayjs ^1.11.13 (~6KB)

**Total bundle impact:** ~50KB (within 80KB headroom from v1.1)

---

_For current project status, see .planning/STATE.md_
